=== RUN   TestEncodeBlockAnnounce
=== PAUSE TestEncodeBlockAnnounce
=== RUN   TestDecodeBlockAnnounce
=== PAUSE TestDecodeBlockAnnounce
=== RUN   TestEncodeBlockAnnounceHandshake
=== PAUSE TestEncodeBlockAnnounceHandshake
=== RUN   TestDecodeBlockAnnounceHandshake
=== PAUSE TestDecodeBlockAnnounceHandshake
=== RUN   TestHandleBlockAnnounceMessage
=== PAUSE TestHandleBlockAnnounceMessage
=== RUN   TestValidateBlockAnnounceHandshake
=== PAUSE TestValidateBlockAnnounceHandshake
=== RUN   TestBuildIdentity
=== PAUSE TestBuildIdentity
=== RUN   TestBuild
=== PAUSE TestBuild
=== RUN   TestMinPeers
=== PAUSE TestMinPeers
=== RUN   TestMaxPeers
=== PAUSE TestMaxPeers
=== RUN   TestProtectUnprotectPeer
=== PAUSE TestProtectUnprotectPeer
=== RUN   TestPersistentPeers
=== PAUSE TestPersistentPeers
=== RUN   TestRemovePeer
=== PAUSE TestRemovePeer
=== RUN   TestSetReservedPeer
=== PAUSE TestSetReservedPeer
=== RUN   TestKadDHT
=== PAUSE TestKadDHT
=== RUN   TestBeginDiscovery
=== PAUSE TestBeginDiscovery
=== RUN   TestBeginDiscovery_ThreeNodes
=== PAUSE TestBeginDiscovery_ThreeNodes
=== RUN   TestGossip
=== PAUSE TestGossip
=== RUN   TestExternalAddrs
=== PAUSE TestExternalAddrs
=== RUN   TestExternalAddrsPublicIP
=== PAUSE TestExternalAddrsPublicIP
=== RUN   TestConnect
=== PAUSE TestConnect
=== RUN   TestBootstrap
=== PAUSE TestBootstrap
=== RUN   TestSend
=== PAUSE TestSend
=== RUN   TestExistingStream
=== PAUSE TestExistingStream
=== RUN   TestStreamCloseMetadataCleanup
=== PAUSE TestStreamCloseMetadataCleanup
=== RUN   Test_PeerSupportsProtocol
=== PAUSE Test_PeerSupportsProtocol
=== RUN   Test_AddReservedPeers
=== PAUSE Test_AddReservedPeers
=== RUN   Test_RemoveReservedPeers
=== PAUSE Test_RemoveReservedPeers
=== RUN   TestStreamCloseEOF
=== PAUSE TestStreamCloseEOF
=== RUN   TestPeerConnect
=== PAUSE TestPeerConnect
=== RUN   TestBannedPeer
=== PAUSE TestBannedPeer
=== RUN   TestPeerReputation
=== PAUSE TestPeerReputation
=== RUN   TestEncodeLightRequest
=== PAUSE TestEncodeLightRequest
=== RUN   TestEncodeLightResponse
=== PAUSE TestEncodeLightResponse
=== RUN   TestDecodeLightMessage
=== PAUSE TestDecodeLightMessage
=== RUN   TestHandleLightMessage_Response
=== PAUSE TestHandleLightMessage_Response
=== RUN   TestMDNS
=== PAUSE TestMDNS
=== RUN   TestMessageCache
=== PAUSE TestMessageCache
=== RUN   TestMessageCacheError
=== PAUSE TestMessageCacheError
=== RUN   TestEncodeBlockRequestMessage
=== PAUSE TestEncodeBlockRequestMessage
=== RUN   TestEncodeBlockRequestMessage_BlockHash
=== PAUSE TestEncodeBlockRequestMessage_BlockHash
=== RUN   TestEncodeBlockRequestMessage_BlockNumber
=== PAUSE TestEncodeBlockRequestMessage_BlockNumber
=== RUN   TestBlockRequestString
=== PAUSE TestBlockRequestString
=== RUN   TestEncodeBlockRequestMessage_NoOptionals
=== PAUSE TestEncodeBlockRequestMessage_NoOptionals
=== RUN   TestEncodeBlockResponseMessage_Empty
=== PAUSE TestEncodeBlockResponseMessage_Empty
=== RUN   TestEncodeBlockResponseMessage_WithBody
=== PAUSE TestEncodeBlockResponseMessage_WithBody
=== RUN   TestEncodeBlockResponseMessage_WithAll
=== PAUSE TestEncodeBlockResponseMessage_WithAll
=== RUN   TestEncodeBlockAnnounceMessage
=== PAUSE TestEncodeBlockAnnounceMessage
=== RUN   TestDecode_BlockAnnounceMessage
=== PAUSE TestDecode_BlockAnnounceMessage
=== RUN   TestEncodeTransactionMessageSingleExtrinsic
=== PAUSE TestEncodeTransactionMessageSingleExtrinsic
=== RUN   TestEncodeTransactionMessageTwoExtrinsics
=== PAUSE TestEncodeTransactionMessageTwoExtrinsics
=== RUN   TestDecodeTransactionMessageOneExtrinsic
=== PAUSE TestDecodeTransactionMessageOneExtrinsic
=== RUN   TestDecodeTransactionMessageTwoExtrinsics
=== PAUSE TestDecodeTransactionMessageTwoExtrinsics
=== RUN   TestDecodeConsensusMessage
=== PAUSE TestDecodeConsensusMessage
=== RUN   TestCreateDecoder_BlockAnnounce
=== PAUSE TestCreateDecoder_BlockAnnounce
=== RUN   TestCreateNotificationsMessageHandler_BlockAnnounce
=== PAUSE TestCreateNotificationsMessageHandler_BlockAnnounce
=== RUN   TestCreateNotificationsMessageHandler_BlockAnnounceHandshake
=== PAUSE TestCreateNotificationsMessageHandler_BlockAnnounceHandshake
=== RUN   Test_HandshakeTimeout
=== PAUSE Test_HandshakeTimeout
=== RUN   TestCreateNotificationsMessageHandler_HandleTransaction
=== PAUSE TestCreateNotificationsMessageHandler_HandleTransaction
=== RUN   TestBlockAnnounceHandshakeSize
=== PAUSE TestBlockAnnounceHandshakeSize
=== RUN   Test_sizedBufferPool
=== PAUSE Test_sizedBufferPool
=== RUN   Test_sizedBufferPool_race
=== PAUSE Test_sizedBufferPool_race
=== RUN   TestStartService
=== PAUSE TestStartService
=== RUN   TestBroadcastMessages
=== PAUSE TestBroadcastMessages
=== RUN   TestBroadcastDuplicateMessage
=== PAUSE TestBroadcastDuplicateMessage
=== RUN   TestService_NodeRoles
=== PAUSE TestService_NodeRoles
=== RUN   TestService_Health
=== PAUSE TestService_Health
=== RUN   TestPersistPeerStore
=== PAUSE TestPersistPeerStore
=== RUN   TestHandleConn
=== PAUSE TestHandleConn
=== RUN   TestSerivceIsMajorSyncMetrics
=== PAUSE TestSerivceIsMajorSyncMetrics
=== RUN   TestStreamManager
=== PAUSE TestStreamManager
=== RUN   TestStreamManager_KeepStream
    stream_manager_test.go:91: 
--- SKIP: TestStreamManager_KeepStream (0.00s)
=== RUN   TestDecodeSyncMessage
=== PAUSE TestDecodeSyncMessage
=== RUN   TestDecodeTransactionHandshake
=== PAUSE TestDecodeTransactionHandshake
=== RUN   TestHandleTransactionMessage
=== PAUSE TestHandleTransactionMessage
=== RUN   TestStringToAddrInfo
--- PASS: TestStringToAddrInfo (0.00s)
=== RUN   TestStringsToAddrInfos
--- PASS: TestStringsToAddrInfos (0.00s)
=== RUN   TestGenerateKey
--- PASS: TestGenerateKey (0.01s)
=== RUN   TestReadLEB128ToUint64
--- PASS: TestReadLEB128ToUint64 (0.00s)
=== RUN   TestInvalidLeb128
--- PASS: TestInvalidLeb128 (0.00s)
=== CONT  TestDecodeBlockAnnounce
=== CONT  TestHandleTransactionMessage
=== CONT  TestMDNS
=== CONT  TestCreateNotificationsMessageHandler_BlockAnnounce
=== CONT  TestCreateDecoder_BlockAnnounce
=== CONT  TestDecodeConsensusMessage
=== CONT  TestDecodeTransactionMessageTwoExtrinsics
=== CONT  TestDecodeTransactionMessageOneExtrinsic
--- PASS: TestDecodeConsensusMessage (0.00s)
--- PASS: TestDecodeTransactionMessageOneExtrinsic (0.00s)
=== CONT  TestEncodeTransactionMessageSingleExtrinsic
=== CONT  Test_HandshakeTimeout
--- PASS: TestDecodeTransactionMessageTwoExtrinsics (0.00s)
=== CONT  TestGossip
--- PASS: TestEncodeTransactionMessageSingleExtrinsic (0.00s)
=== CONT  TestDecode_BlockAnnounceMessage
--- PASS: TestDecode_BlockAnnounceMessage (0.00s)
=== CONT  TestEncodeTransactionMessageTwoExtrinsics
--- PASS: TestEncodeTransactionMessageTwoExtrinsics (0.00s)
=== CONT  TestEncodeBlockAnnounceMessage
--- PASS: TestDecodeBlockAnnounce (0.00s)
=== CONT  TestEncodeBlockResponseMessage_WithAll
--- PASS: TestEncodeBlockAnnounceMessage (0.00s)
=== CONT  TestEncodeBlockResponseMessage_WithBody
--- PASS: TestEncodeBlockResponseMessage_WithBody (0.01s)
=== CONT  TestEncodeBlockResponseMessage_Empty
--- PASS: TestEncodeBlockResponseMessage_WithAll (0.01s)
=== CONT  TestEncodeBlockRequestMessage_NoOptionals
--- PASS: TestEncodeBlockResponseMessage_Empty (0.00s)
=== CONT  TestEncodeBlockRequestMessage_BlockNumber
--- PASS: TestEncodeBlockRequestMessage_NoOptionals (0.00s)
=== CONT  TestBlockRequestString
BlockRequestMessage RequestedData=1 StartingBlock={[220 209 52 103 1 202 131 150 73 110 82 170 39 133 177 116 141 235 109 176 149 81 183 33 89 220 179 224 137 145 2 91]} EndBlockHash=0x0000000000000000000000000000000000000000000000000000000000000000 Direction=1 Max=0
--- PASS: TestBlockRequestString (0.00s)
=== CONT  TestService_NodeRoles
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMDNS3893076944/001/TestMDNS/nodeA/node.key	pkg=network
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_HandshakeTimeout2437718893/001/Test_HandshakeTimeout/nodeA/node.key	pkg=network
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_BlockAnnounce2396403150/001/TestCreateNotificationsMessageHandler_BlockAnnounce/nodeA/node.key	pkg=network
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateDecoder_BlockAnnounce2495888367/001/TestCreateDecoder_BlockAnnounce/nodeA/node.key	pkg=network
--- PASS: TestEncodeBlockRequestMessage_BlockNumber (0.02s)
=== CONT  TestDecodeTransactionHandshake
--- PASS: TestDecodeTransactionHandshake (0.00s)
=== CONT  TestDecodeSyncMessage
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestGossip688433834/001/TestGossip/nodeA/node.key	pkg=network
=== CONT  TestSerivceIsMajorSyncMetrics
--- PASS: TestDecodeSyncMessage (0.00s)
--- PASS: TestSerivceIsMajorSyncMetrics (0.00s)
=== CONT  TestStreamManager
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestService_NodeRoles545505989/001/TestService_NodeRoles/node/node.key	pkg=network
2021-12-07T09:49:08-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleTransactionMessage1609341858/001/TestHandleTransactionMessage/nodeA/node.key	pkg=network
2021-12-07T09:49:08-04:00 WARN Bootstrap is enabled but no bootstrap nodes are defined	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55615/p2p/12D3KooWCVPkhujHMobg6jh8WTYG2GGBbxG8Tbkk7LGvDGBznwcr	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55613/p2p/12D3KooWDBcsgunRRo6rzvXndcjRCAbnNeTGCWq5rdWGbivx2MJW	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55614/p2p/12D3KooWK9xCm2WCMQcbanfS9NPzQAjWExNKFaAeFFi1yCKNWUtE	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55618/p2p/12D3KooWSfUa6hiGg8mAGp8JsDn6eJtEE8dfJcUordWqEmnabAWu	pkg=network
=== CONT  TestService_NodeRoles
    service_test.go:266: 
        	Error Trace:	service_test.go:102
        	            				service_test.go:266
        	Error:      	Received unexpected error:
        	            	failed to listen on any addresses: [listen tcp4 0.0.0.0:7000: bind: address already in use]
        	Test:       	TestService_NodeRoles
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
--- FAIL: TestService_NodeRoles (0.44s)
=== CONT  TestSetReservedPeer
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55617/p2p/12D3KooWAm7gKozL6vQt1WKJCYshJ4Jn9usah1F1wGQUdcw2hvwu	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55616/p2p/12D3KooWCyXFxiLpEYdUh6xSSdHJJ5UizvSz3Gqfi152hU2rYBZm	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSetReservedPeer583867775/001/TestSetReservedPeer/node0/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55621/p2p/12D3KooWGBVooSxRPATXs761zLnbpwNxmxWLKMRYE2whQVBJNg1t	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_BlockAnnounce2396403150/002/TestCreateNotificationsMessageHandler_BlockAnnounce/nodeB/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMDNS3893076944/002/TestMDNS/nodeB/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 2 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_HandshakeTimeout2437718893/002/Test_HandshakeTimeout/nodeB/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestGossip688433834/002/TestGossip/nodeB/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSetReservedPeer583867775/002/TestSetReservedPeer/node1/node.key	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:09-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:09-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55622/p2p/12D3KooWAnM2m6Ut5pEYbPfrzpi1L42y8ZdY6fRyzyen3Sbr4FiC	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55624/p2p/12D3KooWKRyzVWW6ChFjQjK4miCty85Niy49tpPV95XdKu1BcvMA	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55623/p2p/12D3KooWAEettb7XdCDLnY9M4RFpajbjLMgTt7LZWNVnDUpLwLJg	pkg=network
--- PASS: TestCreateDecoder_BlockAnnounce (1.27s)
=== CONT  TestHandleConn
=== CONT  TestBeginDiscovery_ThreeNodes
--- PASS: TestHandleTransactionMessage (1.29s)
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55625/p2p/12D3KooWSbZjEdFRsH486bf3MmFUYhMevKbsktjeTg3Mdbwu4uXE	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleConn3732804873/001/TestHandleConn/nodeA/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBeginDiscovery_ThreeNodes4171104864/001/TestBeginDiscovery_ThreeNodes/nodeA/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55626/p2p/12D3KooWE9V1PzooukD5cu2rg3D7hjwHWgwAgo187BnRnxz9aaJp	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55627/p2p/12D3KooWBYG5oegE8VD9BfNnGJxPKkaj6GxRJPyQytYyVgujAc1D	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55628/p2p/12D3KooWSLyN3VpKLx8srHnu9oGXm3PaaWGNK99GszQS44Vqzv9p	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 DBUG gossiping from host 12D3KooWK9xCm2WCMQcbanfS9NPzQAjWExNKFaAeFFi1yCKNWUtE message of type 0: BlockAnnounceHandshake Roles=4 BestBlockNumber=77 BestBlockHash=0x0100000000000000000000000000000000000000000000000000000000000000 GenesisHash=0x0200000000000000000000000000000000000000000000000000000000000000	pkg=network
2021-12-07T09:49:10-04:00 EROR message type 0 not supported by any notifications protocol	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestGossip688433834/003/TestGossip/nodeC/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
--- PASS: TestCreateNotificationsMessageHandler_BlockAnnounce (1.96s)
=== CONT  TestHandleBlockAnnounceMessage
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSetReservedPeer583867775/003/TestSetReservedPeer/node2/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleBlockAnnounceMessage849112843/001/TestHandleBlockAnnounceMessage/nodeA/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:10-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:10-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55629/p2p/12D3KooWHjw8bfdCbmdchtqs3tPC42Xq8kb5fswhe1KG4YBmtaA2	pkg=network
==================
WARNING: DATA RACE
Write at 0x000005df4ec8 by goroutine 93:
  github.com/ChainSafe/gossamer/dot/network.setupStreamManagerTest.func1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/stream_manager_test.go:28 +0x32
  testing.(*common).Cleanup.func1()
      /usr/local/go/src/testing/testing.go:912 +0x199
  testing.(*common).runCleanup()
      /usr/local/go/src/testing/testing.go:1049 +0x154
  testing.tRunner.func2()
      /usr/local/go/src/testing/testing.go:1253 +0x4f
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1265 +0x268
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous read at 0x000005df4ec8 by goroutine 792:
  github.com/ChainSafe/gossamer/dot/network.(*streamManager).start.func1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/stream_manager.go:39 +0x4a

Goroutine 93 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 792 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.(*streamManager).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/stream_manager.go:38 +0x90
  github.com/ChainSafe/gossamer/dot/network.(*Service).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:284 +0x136c
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:106 +0x788
  github.com/ChainSafe/gossamer/dot/network.TestSetReservedPeer()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/connmgr_test.go:225 +0x164
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
=== CONT  TestStreamManager
    testing.go:1152: race detected during execution of test
--- FAIL: TestStreamManager (2.01s)
=== CONT  TestValidateBlockAnnounceHandshake
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleConn3732804873/002/TestHandleConn/nodeB/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBeginDiscovery_ThreeNodes4171104864/002/TestBeginDiscovery_ThreeNodes/nodeB/node.key	pkg=network
2021-12-07T09:49:10-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestValidateBlockAnnounceHandshake4090063501/001/TestValidateBlockAnnounceHandshake/nodeA/node.key	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55630/p2p/12D3KooWBMDWaZKUqEbHE1GB9jgVopTtvo9CL1XYrg23TSSWNAjT	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55631/p2p/12D3KooWCTamdmKZuoDA7yETaL6yuzRwp1asYQbF1Gz5KSjiRuDs	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55633/p2p/12D3KooWEWEEcLvXRv4y6Di9XkD7pm1cs2UVtQutogwWnvuYb8em	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55632/p2p/12D3KooWQyxMmfzo3iZHHkX7B9o1xjHuMqKyW2TP9quj25zCpkKu	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55634/p2p/12D3KooWCZqJxdxGgJ7U9dyvRCZGRxtghHFFCHJDa4F4hoBbWAwZ	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestGossip
    gossip_test.go:93: 
        	Error Trace:	gossip_test.go:93
        	Error:      	Received unexpected error:
        	            	protocol not supported
        	Test:       	TestGossip
2021-12-07T09:49:11-04:00 WARN failed to open connection for peer 12D3KooWCVPkhujHMobg6jh8WTYG2GGBbxG8Tbkk7LGvDGBznwcr: context canceled	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSetReservedPeer583867775/004/TestSetReservedPeer/node3/node.key	pkg=network
2021-12-07T09:49:11-04:00 WARN Bootstrap is enabled but no bootstrap nodes are defined	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBeginDiscovery_ThreeNodes4171104864/003/TestBeginDiscovery_ThreeNodes/nodeC/node.key	pkg=network
=== CONT  TestHandleBlockAnnounceMessage
    testing.go:1152: race detected during execution of test
=== CONT  TestBuild
--- FAIL: TestHandleBlockAnnounceMessage (1.08s)
=== CONT  TestHandleLightMessage_Response
--- PASS: TestBuild (0.05s)
=== CONT  TestGossip
    testing.go:1152: race detected during execution of test
--- FAIL: TestGossip (3.11s)
=== CONT  TestMessageCache
=== CONT  TestEncodeLightResponse
--- PASS: TestValidateBlockAnnounceHandshake (1.11s)
=== CONT  TestMDNS
    testing.go:1152: race detected during execution of test
--- FAIL: TestMDNS (3.15s)
=== CONT  TestEncodeLightRequest
--- PASS: TestEncodeLightRequest (0.00s)
=== CONT  TestPeerReputation
--- PASS: TestEncodeLightResponse (0.00s)
=== CONT  TestBannedPeer
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:11-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:11-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55636/p2p/12D3KooWRri33ShHTfZFqYSqRhfx5edjo8irAycQCQUnL7DZpqXS	pkg=network
2021-12-07T09:49:11-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleLightMessage_Response1764702853/001/TestHandleLightMessage_Response/nodeA/node.key	pkg=network
2021-12-07T09:49:11-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPeerReputation2161340469/001/TestPeerReputation/nodeA/node.key	pkg=network
2021-12-07T09:49:11-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBannedPeer1677319629/001/TestBannedPeer/nodeA/node.key	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55637/p2p/12D3KooWHck5LMQahgos6W6L9kLnbUCxoihqTiyqffbRTRLBNL7f	pkg=network
2021-12-07T09:49:12-04:00 DBUG connection successful with peer 12D3KooWGBVooSxRPATXs761zLnbpwNxmxWLKMRYE2whQVBJNg1t	pkg=network
2021-12-07T09:49:12-04:00 DBUG connection successful with peer 12D3KooWE9V1PzooukD5cu2rg3D7hjwHWgwAgo187BnRnxz9aaJp	pkg=network
=== CONT  TestHandleConn
    testing.go:1152: race detected during execution of test
--- FAIL: TestHandleConn (2.26s)
=== CONT  TestDecodeLightMessage
--- PASS: TestDecodeLightMessage (0.01s)
=== CONT  TestStreamCloseEOF
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55638/p2p/12D3KooW9vANHSkThbzaSaHdx8vwU1T3AkiEQs3oR4B9S7YcxisY	pkg=network
2021-12-07T09:49:12-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestStreamCloseEOF3614206454/001/TestStreamCloseEOF/nodeA/node.key	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55639/p2p/12D3KooWCsMRrBPgr9VJXW7rJbWytzQ8S4NXAFHpgjrp4TcvE5qL	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55640/p2p/12D3KooWNNpQ1tBpcwm9KetFszUn83gM3Acu6PwUHqLRsWc21H1M	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:12-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55641/p2p/12D3KooWKzzvfpvvd1TmG86vGVfxnXUbbnAMs7zTg3Vsva9WWxQM	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 DBUG starting DHT with bootnodes [{12D3KooWEWEEcLvXRv4y6Di9XkD7pm1cs2UVtQutogwWnvuYb8em: [/ip4/127.0.0.1/tcp/55633]} {12D3KooWHck5LMQahgos6W6L9kLnbUCxoihqTiyqffbRTRLBNL7f: [/ip4/127.0.0.1/tcp/55637]}]...	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:12-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPeerReputation2161340469/002/TestPeerReputation/nodeB/node.key	pkg=network
2021-12-07T09:49:12-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestHandleLightMessage_Response1764702853/002/TestHandleLightMessage_Response/nodeB/node.key	pkg=network
2021-12-07T09:49:12-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBannedPeer1677319629/002/TestBannedPeer/nodeB/node.key	pkg=network
2021-12-07T09:49:12-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestStreamCloseEOF3614206454/002/TestStreamCloseEOF/nodeB/node.key	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55643/p2p/12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55642/p2p/12D3KooWLvG14Zj9UP9CLGmhs6NZFRoY3HYwVMiP3uP3V98xCCKo	pkg=network
2021-12-07T09:49:13-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55644/p2p/12D3KooWJb4s5aUvMFvVdsFy9FVBknTe9TF6F5Gt3jLgFqVPqkYe	pkg=network
2021-12-07T09:49:13-04:00 DBUG connection successful with peer 12D3KooWBMDWaZKUqEbHE1GB9jgVopTtvo9CL1XYrg23TSSWNAjT	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55645/p2p/12D3KooWByC5btgjovc3oHWUwP5jcPadehCBUB5ni79ZiT2jtwNZ	pkg=network
==================
WARNING: DATA RACE
Write at 0x00c03f244550 by goroutine 36:
  runtime.closechan()
      /usr/local/go/src/runtime/chan.go:355 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Stop()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:144 +0x7e
  github.com/ChainSafe/gossamer/dot/network.(*Service).Stop()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:456 +0x223
  github.com/ChainSafe/gossamer/dot/network.createTestService.func1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:110 +0x4a
  testing.(*common).Cleanup.func1()
      /usr/local/go/src/testing/testing.go:912 +0x199
  testing.(*common).runCleanup()
      /usr/local/go/src/testing/testing.go:1049 +0x154
  testing.tRunner.func2()
      /usr/local/go/src/testing/testing.go:1253 +0x4f
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1265 +0x268
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous read at 0x00c03f244550 by goroutine 677:
  runtime.chansend()
      /usr/local/go/src/runtime/chan.go:158 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Incoming()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:86 +0xc4
  github.com/ChainSafe/gossamer/dot/network.(*Service).handleConn()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:435 +0xfb
  github.com/ChainSafe/gossamer/dot/network.(*Service).handleConn-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:433 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Swarm).addConn·dwrap·13()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm.go:285 +0x58

Goroutine 36 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264
==================
=== CONT  TestSetReservedPeer
    testing.go:1152: race detected during execution of test
=== CONT  TestPeerConnect
--- FAIL: TestSetReservedPeer (4.31s)
2021-12-07T09:49:13-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPeerConnect1443991448/001/TestPeerConnect/nodeA/node.key	pkg=network
2021-12-07T09:49:13-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:13-04:00 DBUG starting DHT with bootnodes [{12D3KooWSLyN3VpKLx8srHnu9oGXm3PaaWGNK99GszQS44Vqzv9p: [/ip4/127.0.0.1/tcp/55628]}]...	pkg=network
2021-12-07T09:49:13-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to advertise in the DHT: failed to find any peer in table	pkg=network
2021-12-07T09:49:13-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 WARN ignoring LightRequest without request data	pkg=network
2021-12-07T09:49:13-04:00 DBUG LightResponse message: RemoteCallResponse=Proof = RemoteReadResponse=Proof = RemoteHeaderResponse=Header =[] Proof = RemoteChangesResponse=Max = Proof =[] Roots=[] RootsProof=	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to send LightResponse message to peer 12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H: stream closed	pkg=network
2021-12-07T09:49:13-04:00 DBUG cleaning up inbound handshake data for protocol=/gossamer/test/0/light/2, peer=12D3KooW9vANHSkThbzaSaHdx8vwU1T3AkiEQs3oR4B9S7YcxisY	pkg=network
2021-12-07T09:49:13-04:00 DBUG LightResponse message: RemoteCallResponse=Proof = RemoteReadResponse=Proof = RemoteHeaderResponse=Header =[] Proof = RemoteChangesResponse=Max = Proof =[] Roots=[] RootsProof=	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to send LightResponse message to peer 12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H: stream closed	pkg=network
2021-12-07T09:49:13-04:00 DBUG LightResponse message: RemoteCallResponse=Proof = RemoteReadResponse=Proof = RemoteHeaderResponse=Header =[] Proof = RemoteChangesResponse=Max = Proof =[] Roots=[] RootsProof=	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to send LightResponse message to peer 12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H: stream closed	pkg=network
2021-12-07T09:49:13-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55646/p2p/12D3KooWS4VxjQeMheNz5wm9VVxcS8kd68pEHaaaz53NSfH1avLA	pkg=network
2021-12-07T09:49:13-04:00 DBUG LightResponse message: RemoteCallResponse=Proof = RemoteReadResponse=Proof = RemoteHeaderResponse=Header =[] Proof = RemoteChangesResponse=Max = Proof =[] Roots=[] RootsProof=	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to send LightResponse message to peer 12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H: stream closed	pkg=network
2021-12-07T09:49:13-04:00 DBUG LightResponse message: RemoteCallResponse=Proof = RemoteReadResponse=Proof = RemoteHeaderResponse=Header =[] Proof = RemoteChangesResponse=Max = Proof =[] Roots=[] RootsProof=	pkg=network
2021-12-07T09:49:13-04:00 WARN failed to send LightResponse message to peer 12D3KooWMyVcyWYTi7V1xW132eUod8Q8Y6GrxDtCGpY1QS5m7k8H: stream closed	pkg=network
2021-12-07T09:49:13-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:13-04:00 DBUG connection successful with peer 12D3KooWLvG14Zj9UP9CLGmhs6NZFRoY3HYwVMiP3uP3V98xCCKo	pkg=network
2021-12-07T09:49:13-04:00 DBUG connection successful with peer 12D3KooWJb4s5aUvMFvVdsFy9FVBknTe9TF6F5Gt3jLgFqVPqkYe	pkg=network
2021-12-07T09:49:13-04:00 CRIT highest rated peer is below bannedThresholdValue	pkg=peerset
2021-12-07T09:49:13-04:00 DBUG connection dropped successfully for peer 12D3KooWJb4s5aUvMFvVdsFy9FVBknTe9TF6F5Gt3jLgFqVPqkYe	pkg=network
=== CONT  TestHandleLightMessage_Response
    testing.go:1152: race detected during execution of test
=== CONT  Test_RemoveReservedPeers
--- FAIL: TestHandleLightMessage_Response (1.97s)
2021-12-07T09:49:13-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_RemoveReservedPeers2335871119/001/Test_RemoveReservedPeers/nodeA/node.key	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c045a3a600 by goroutine 54:
  runtime.mapaccess2_faststr()
      /usr/local/go/src/runtime/map_faststr.go:107 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*PeersState).getNode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerstate.go:114 +0x8b
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).PeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:109 +0x31
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:704 +0x7bd
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c045a3a600 by goroutine 730:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).reportPeer()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:330 +0x288
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).doWork()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:715 +0x529
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start·dwrap·1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x47

Goroutine 54 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 730 (running) created at:
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x170
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:123 +0x154
  github.com/ChainSafe/gossamer/dot/network.(*Service).startPeerSetHandler()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:656 +0x81
  github.com/ChainSafe/gossamer/dot/network.(*Service).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:258 +0xea6
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:106 +0x788
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:671 +0x1e4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c01527e708 by goroutine 54:
  github.com/ChainSafe/gossamer/dot/peerset.(*PeersState).getNode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerstate.go:114 +0x99
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).PeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:109 +0x31
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:704 +0x7bd
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c01527e708 by goroutine 730:
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).reportPeer()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:330 +0x297
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).doWork()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:715 +0x529
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start·dwrap·1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x47

Goroutine 54 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 730 (running) created at:
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x170
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:123 +0x154
  github.com/ChainSafe/gossamer/dot/network.(*Service).startPeerSetHandler()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:656 +0x81
  github.com/ChainSafe/gossamer/dot/network.(*Service).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:258 +0xea6
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:106 +0x788
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:671 +0x1e4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c018b32470 by goroutine 54:
  github.com/ChainSafe/gossamer/dot/peerset.(*node).getReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerstate.go:91 +0x10a
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).PeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:113 +0x117
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:704 +0x7bd
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c018b32470 by goroutine 730:
  github.com/ChainSafe/gossamer/dot/peerset.(*node).addReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerstate.go:95 +0x210
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).reportPeer()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:329 +0x41
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).doWork()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:715 +0x529
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start·dwrap·1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x47

Goroutine 54 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 730 (running) created at:
  github.com/ChainSafe/gossamer/dot/peerset.(*PeerSet).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/peerset.go:674 +0x170
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:123 +0x154
  github.com/ChainSafe/gossamer/dot/network.(*Service).startPeerSetHandler()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:656 +0x81
  github.com/ChainSafe/gossamer/dot/network.(*Service).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:258 +0xea6
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:106 +0x788
  github.com/ChainSafe/gossamer/dot/network.TestPeerReputation()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:671 +0x1e4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55647/p2p/12D3KooWE2A3Rvu8bA3PtPJetMKmCejMwCZSfhZY21yxaNik37MN	pkg=network
=== CONT  TestPeerReputation
    testing.go:1152: race detected during execution of test
=== CONT  Test_AddReservedPeers
--- FAIL: TestPeerReputation (2.15s)
2021-12-07T09:49:14-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_AddReservedPeers3796944281/001/Test_AddReservedPeers/nodeA/node.key	pkg=network
2021-12-07T09:49:14-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55649/p2p/12D3KooWRBWijSckfLN79ALNMbUsLz8yGHpVXF74rDpFJUJo9Cbh	pkg=network
2021-12-07T09:49:14-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPeerConnect1443991448/002/TestPeerConnect/nodeB/node.key	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55650/p2p/12D3KooWGHCLxXmiYyBUFfrKNfAUPgb1tihtSnK5Vbmd6mbpcWiM	pkg=network
2021-12-07T09:49:14-04:00 CRIT highest rated peer is below bannedThresholdValue	pkg=peerset
2021-12-07T09:49:14-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_RemoveReservedPeers2335871119/002/Test_RemoveReservedPeers/nodeB/node.key	pkg=network
2021-12-07T09:49:14-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:14-04:00 DBUG starting DHT with bootnodes [{12D3KooWSLyN3VpKLx8srHnu9oGXm3PaaWGNK99GszQS44Vqzv9p: [/ip4/127.0.0.1/tcp/55628]}]...	pkg=network
2021-12-07T09:49:14-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55651/p2p/12D3KooWLjeMK8aNp1gzhnMDrXwZ1VMxVrmX4pqXJWnhFbCj2Vjq	pkg=network
2021-12-07T09:49:14-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_AddReservedPeers3796944281/002/Test_AddReservedPeers/nodeB/node.key	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:14-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55652/p2p/12D3KooWSUE95oHwaxf8HZKbc68HUBHDnoeH7bWh7oJg39RRbbzA	pkg=network
2021-12-07T09:49:14-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:14-04:00 DBUG connection successful with peer 12D3KooWGHCLxXmiYyBUFfrKNfAUPgb1tihtSnK5Vbmd6mbpcWiM	pkg=network
=== CONT  TestPeerConnect
    testing.go:1152: race detected during execution of test
--- FAIL: TestPeerConnect (1.52s)
=== CONT  TestStreamCloseMetadataCleanup
2021-12-07T09:49:15-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestStreamCloseMetadataCleanup4042372936/001/TestStreamCloseMetadataCleanup/nodeA/node.key	pkg=network
2021-12-07T09:49:15-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55653/p2p/12D3KooWGkYFWKtDjrjWiuvsxiReHkBDXSb8ofZ3DEbJzDAE3Bw5	pkg=network
2021-12-07T09:49:15-04:00 DBUG connection successful with peer 12D3KooWLjeMK8aNp1gzhnMDrXwZ1VMxVrmX4pqXJWnhFbCj2Vjq	pkg=network
2021-12-07T09:49:15-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 DBUG connection successful with peer 12D3KooWSUE95oHwaxf8HZKbc68HUBHDnoeH7bWh7oJg39RRbbzA	pkg=network
=== CONT  TestMessageCache
    testing.go:1152: race detected during execution of test
--- FAIL: TestMessageCache (3.51s)
=== CONT  TestExistingStream
2021-12-07T09:49:15-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestExistingStream2557317831/001/TestExistingStream/nodeA/node.key	pkg=network
2021-12-07T09:49:15-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:15-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:15-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestStreamCloseMetadataCleanup4042372936/002/TestStreamCloseMetadataCleanup/nodeB/node.key	pkg=network
=== CONT  Test_RemoveReservedPeers
    testing.go:1152: race detected during execution of test
=== CONT  TestSend
--- FAIL: Test_RemoveReservedPeers (1.95s)
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55654/p2p/12D3KooWGAx1JXaMk79v6fzXstxr5tgpXwwpyVJ2CvhvinS7YosK	pkg=network
=== CONT  TestBootstrap
--- PASS: Test_AddReservedPeers (1.73s)
2021-12-07T09:49:15-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSend3377903579/001/TestSend/nodeA/node.key	pkg=network
2021-12-07T09:49:15-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBootstrap1193564528/001/TestBootstrap/nodeA/node.key	pkg=network
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:15-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:15-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55655/p2p/12D3KooWANbAbE2yLdhGKtaXE2Q2RPqL89zD8wpFEK5ArpSAmPZH	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55656/p2p/12D3KooWHdnCoSTysuxS9g6pQDuibZmGY5nYtm9C2KbNcnPaStth	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55657/p2p/12D3KooWHDp7ymbYSJw3XEbv44GhmRx7bZypa7N8SGEWt7ux15nT	pkg=network
2021-12-07T09:49:16-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestExistingStream2557317831/002/TestExistingStream/nodeB/node.key	pkg=network
2021-12-07T09:49:16-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestBeginDiscovery_ThreeNodes
    testing.go:1152: race detected during execution of test
--- FAIL: TestBeginDiscovery_ThreeNodes (6.42s)
=== CONT  TestConnect
2021-12-07T09:49:16-04:00 DBUG connection successful with peer 12D3KooWJb4s5aUvMFvVdsFy9FVBknTe9TF6F5Gt3jLgFqVPqkYe	pkg=network
2021-12-07T09:49:16-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestConnect3518812401/001/TestConnect/nodeA/node.key	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55658/p2p/12D3KooWRpX9drYiXnkEXno8ceAD2YawXTnMNVecR2gqxgjxPoBD	pkg=network
2021-12-07T09:49:16-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestSend3377903579/002/TestSend/nodeB/node.key	pkg=network
2021-12-07T09:49:16-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBootstrap1193564528/002/TestBootstrap/nodeB/node.key	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55659/p2p/12D3KooWP5SL3UEs9WbxpHoCYGMV9xy7p1DGB3kyqqYk1dnWKoJp	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55660/p2p/12D3KooWEBa7TXRqxb4Vd35za34iZYW13F3UHzNQeGGu8KMeBgzh	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:16-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:16-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55661/p2p/12D3KooWNSwHuuGu4Rq1EryCCHiDyfCtnH8oswTsxYYUoi7FaWqq	pkg=network
2021-12-07T09:49:16-04:00 DBUG bootstrapping to peer 12D3KooWHDp7ymbYSJw3XEbv44GhmRx7bZypa7N8SGEWt7ux15nT	pkg=network
2021-12-07T09:49:16-04:00 DBUG connection successful with peer 12D3KooWHDp7ymbYSJw3XEbv44GhmRx7bZypa7N8SGEWt7ux15nT	pkg=network
=== CONT  TestBannedPeer
    testing.go:1152: race detected during execution of test
--- FAIL: TestBannedPeer (5.07s)
=== CONT  Test_sizedBufferPool
=== CONT  TestKadDHT
--- PASS: Test_sizedBufferPool (0.00s)
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestKadDHT3033539690/001/TestKadDHT/node0/node.key	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55663/p2p/12D3KooWFLXde5C18HZ88BJcWnsXQhKEhd1J9BX5brRfFegoD3tx	pkg=network
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestConnect3518812401/002/TestConnect/nodeB/node.key	pkg=network
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55664/p2p/12D3KooWKEfYx2nr1HeNg41BSa2KgLmnkmLuUjKTBQTLLzKdVN1n	pkg=network
=== CONT  TestEncodeBlockAnnounceHandshake
--- PASS: TestBootstrap (1.64s)
=== CONT  TestBeginDiscovery
--- PASS: TestEncodeBlockAnnounceHandshake (0.00s)
2021-12-07T09:49:17-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBeginDiscovery1717403580/001/TestBeginDiscovery/nodeA/node.key	pkg=network
2021-12-07T09:49:17-04:00 DBUG cleaning up inbound handshake data for protocol=/gossamer/test/0/block-announces/1, peer=12D3KooWGkYFWKtDjrjWiuvsxiReHkBDXSb8ofZ3DEbJzDAE3Bw5	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55665/p2p/12D3KooWDnfzYuoGtGTuVFzxZsaAXRNwuAGdbdDmZSSwuyqPeKPZ	pkg=network
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestKadDHT3033539690/002/TestKadDHT/node1/node.key	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:17-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:17-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55666/p2p/12D3KooWSjBCybiZtiTbjMC6xBxAbiVfTdNuKrSfd1BwTgptHA2v	pkg=network
2021-12-07T09:49:17-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestDecodeBlockAnnounceHandshake
--- PASS: TestConnect (1.55s)
=== CONT  TestCreateNotificationsMessageHandler_BlockAnnounceHandshake
--- PASS: TestDecodeBlockAnnounceHandshake (0.00s)
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_BlockAnnounceHandshake1062558172/001/TestCreateNotificationsMessageHandler_BlockAnnounceHandshake/nodeA/node.key	pkg=network
2021-12-07T09:49:18-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBeginDiscovery1717403580/002/TestBeginDiscovery/nodeB/node.key	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c01932eba0 by goroutine 46:
  runtime.mapaccess1_faststr()
      /usr/local/go/src/runtime/map_faststr.go:12 +0x0
  github.com/ChainSafe/gossamer/dot/network.TestExistingStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:262 +0xcbc
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c01932eba0 by goroutine 198:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x1f5
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 46 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 198 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c00127c608 by goroutine 46:
  github.com/ChainSafe/gossamer/dot/network.TestExistingStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:262 +0xcc9
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c00127c608 by goroutine 198:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x204
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 46 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 198 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
2021-12-07T09:49:18-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55667/p2p/12D3KooWGmJKonCaP9NGW4nq6B2RQyYvoWKUJWQGGzCCPjCxpC7Z	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55668/p2p/12D3KooWDfc5yFjQG1u6YmN36UwTMzpBMiFn7igCLAgRUbKCxr9K	pkg=network
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestKadDHT3033539690/003/TestKadDHT/node2/node.key	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55669/p2p/12D3KooWA8qur5nqe3oH5NbQQS1xqsMDqgBGPRKHufqhEnnnuMnW	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c02075c270 by goroutine 45:
  runtime.mapaccess2_faststr()
      /usr/local/go/src/runtime/map_faststr.go:107 +0x0
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:209 +0xa3c
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c02075c270 by goroutine 984:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x1f5
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c063190b88 by goroutine 45:
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:209 +0xa4d
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c063190b88 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x204
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c00fcad0b0 by goroutine 45:
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xae4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c00fcad0b0 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x17c
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c03f180900 by goroutine 45:
  reflect.typedmemmove()
      /usr/local/go/src/runtime/mbarrier.go:178 +0x0
  reflect.packEface()
      /usr/local/go/src/reflect/value.go:123 +0xae
  reflect.valueInterface()
      /usr/local/go/src/reflect/value.go:1381 +0x18a
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:154 +0x9dc
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f180900 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:194 +0x77b
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c03f180908 by goroutine 45:
  reflect.Value.IsNil()
      /usr/local/go/src/reflect/value.go:1425 +0x1d8
  reflect.deepValueEqual.func1()
      /usr/local/go/src/reflect/deepequal.go:50 +0x11d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:55 +0x16d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f180908 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:195 +0x7c8
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c03f180918 by goroutine 45:
  reflect.Value.IsNil()
      /usr/local/go/src/reflect/value.go:1419 +0x225
  reflect.deepValueEqual.func1()
      /usr/local/go/src/reflect/deepequal.go:50 +0x11d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:55 +0x16d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f180918 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:196 +0x835
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c0192fcfa0 by goroutine 45:
  reflect.typedmemmove()
      /usr/local/go/src/runtime/mbarrier.go:178 +0x0
  reflect.packEface()
      /usr/local/go/src/reflect/value.go:123 +0xae
  reflect.valueInterface()
      /usr/local/go/src/reflect/value.go:1381 +0x18a
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:154 +0x9dc
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:90 +0x1684
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c0192fcfa0 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:182 +0x6fa
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c03f180920 by goroutine 45:
  reflect.typedmemmove()
      /usr/local/go/src/runtime/mbarrier.go:178 +0x0
  reflect.packEface()
      /usr/local/go/src/reflect/value.go:123 +0xae
  reflect.valueInterface()
      /usr/local/go/src/reflect/value.go:1381 +0x18a
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:154 +0x9dc
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f180920 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:197 +0x89a
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c03f180928 by goroutine 45:
  reflect.Value.IsNil()
      /usr/local/go/src/reflect/value.go:1419 +0x225
  reflect.deepValueEqual.func1()
      /usr/local/go/src/reflect/deepequal.go:50 +0x11d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:55 +0x16d
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f180928 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:198 +0x8ba
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c00fa4e35c by goroutine 45:
  reflect.typedmemmove()
      /usr/local/go/src/runtime/mbarrier.go:178 +0x0
  reflect.packEface()
      /usr/local/go/src/reflect/value.go:123 +0xae
  reflect.valueInterface()
      /usr/local/go/src/reflect/value.go:1381 +0x18a
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:154 +0x9dc
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:123 +0x142c
  reflect.deepValueEqual()
      /usr/local/go/src/reflect/deepequal.go:120 +0xfe7
  reflect.DeepEqual()
      /usr/local/go/src/reflect/deepequal.go:218 +0x404
  github.com/stretchr/testify/assert.ObjectsAreEqual()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:65 +0x184
  github.com/stretchr/testify/assert.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/assert/assertions.go:343 +0x212
  github.com/stretchr/testify/require.Equal()
      /Users/eclesiojunior/go/pkg/mod/github.com/stretchr/testify@v1.7.0/require/require.go:162 +0xc8
  github.com/ChainSafe/gossamer/dot/network.TestSend()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:212 +0xb54
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c00fa4e358 by goroutine 984:
  github.com/ChainSafe/gossamer/dot/network/proto.(*BlockRequest).Reset()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/proto/api.v1.pb.go:102 +0x37
  google.golang.org/protobuf/proto.Reset()
      /Users/eclesiojunior/go/pkg/mod/google.golang.org/protobuf@v1.27.1/proto/reset.go:18 +0x4d
  google.golang.org/protobuf/proto.UnmarshalOptions.unmarshal()
      /Users/eclesiojunior/go/pkg/mod/google.golang.org/protobuf@v1.27.1/proto/decode.go:77 +0xcc
  google.golang.org/protobuf/proto.Unmarshal()
      /Users/eclesiojunior/go/pkg/mod/google.golang.org/protobuf@v1.27.1/proto/decode.go:50 +0xa4
  github.com/ChainSafe/gossamer/dot/network.(*BlockRequestMessage).Decode()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/message.go:152 +0xf4
  github.com/ChainSafe/gossamer/dot/network.testBlockRequestMessageDecoder()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:211 +0x51
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:177 +0x29e
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 45 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 984 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
2021-12-07T09:49:18-04:00 DBUG failed to read from stream using protocol /gossamer/test/0: failed to read length: stream reset	pkg=network
=== CONT  TestSend
    testing.go:1152: race detected during execution of test
--- FAIL: TestSend (2.78s)
=== CONT  TestMaxPeers
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMaxPeers3065712103/001/TestMaxPeers/node0/node.key	pkg=network
2021-12-07T09:49:18-04:00 WARN min peers higher than max peers; setting to default	pkg=network
=== CONT  TestStreamCloseMetadataCleanup
    testing.go:1152: race detected during execution of test
--- FAIL: TestStreamCloseMetadataCleanup (3.70s)
=== CONT  TestPersistPeerStore
2021-12-07T09:49:18-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:18-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55671/p2p/12D3KooWHM3njgDQCkyv4HaibNjUmqcvYfhG7MgiQfhyH9yWmTpP	pkg=network
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPersistPeerStore1461834304/001/TestPersistPeerStore/node0/node.key	pkg=network
2021-12-07T09:49:18-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_BlockAnnounceHandshake1062558172/002/TestCreateNotificationsMessageHandler_BlockAnnounceHandshake/nodeB/node.key	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c0011efeb8 by goroutine 51:
  github.com/ChainSafe/gossamer/dot/network.TestStreamCloseEOF()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:555 +0xa5e
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c0011efeb8 by goroutine 813:
  [failed to restore the stack]

Goroutine 51 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264
==================
2021-12-07T09:49:18-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:18-04:00 DBUG starting DHT with bootnodes [{12D3KooWDfc5yFjQG1u6YmN36UwTMzpBMiFn7igCLAgRUbKCxr9K: [/ip4/127.0.0.1/tcp/55668]}]...	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55672/p2p/12D3KooWLtXSCQueZk1zQQZRmyY7VLQJggATzyTBAXTHssoa9opF	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55673/p2p/12D3KooWDpc1zkdWj7BVwARqNTA583rqW5KcYjTDne2xSe4XWxqa	pkg=network
=== CONT  TestStreamCloseEOF
    testing.go:1152: race detected during execution of test
--- FAIL: TestStreamCloseEOF (6.76s)
=== CONT  TestService_Health
==================
WARNING: DATA RACE
Read at 0x00c0458f9860 by goroutine 46:
  runtime.mapaccess1_faststr()
      /usr/local/go/src/runtime/map_faststr.go:12 +0x0
  github.com/ChainSafe/gossamer/dot/network.TestExistingStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:274 +0x1008
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c0458f9860 by goroutine 440:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x1f5
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 46 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 440 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c000963268 by goroutine 46:
  github.com/ChainSafe/gossamer/dot/network.TestExistingStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/host_test.go:274 +0x1015
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c000963268 by goroutine 440:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x204
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 46 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 440 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
2021-12-07T09:49:19-04:00 DBUG failed to read from stream using protocol /gossamer/test/0: failed to read length: stream reset	pkg=network
2021-12-07T09:49:19-04:00 DBUG failed to read from stream using protocol /gossamer/test/0: failed to read length: stream reset	pkg=network
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestService_Health1518250653/001/TestService_Health/nodeA/node.key	pkg=network
2021-12-07T09:49:19-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestExistingStream
    testing.go:1152: race detected during execution of test
--- FAIL: TestExistingStream (3.91s)
=== CONT  TestEncodeBlockRequestMessage_BlockHash
=== CONT  TestRemovePeer
--- PASS: TestEncodeBlockRequestMessage_BlockHash (0.00s)
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55674/p2p/12D3KooWHRqmdG5YWNmwXsiaw5LSBt7f1TgzhJ9oxcMzqUWu6Zhm	pkg=network
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMaxPeers3065712103/002/TestMaxPeers/node1/node.key	pkg=network
2021-12-07T09:49:19-04:00 WARN min peers higher than max peers; setting to default	pkg=network
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestRemovePeer2086655697/001/TestRemovePeer/nodeA/node.key	pkg=network
2021-12-07T09:49:19-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55675/p2p/12D3KooWMkDRTnrBF1H14jSSP5m9Rkxuned2qzMoouAdSNbzSYNV	pkg=network
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPersistPeerStore1461834304/002/TestPersistPeerStore/node1/node.key	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55676/p2p/12D3KooWEAt3EiWF6vqj4QWLJAs8Yu9QZgqxo7hprVMFsjhAJJ4g	pkg=network
2021-12-07T09:49:19-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 DBUG cleaning up inbound handshake data for protocol=/gossamer/test/0/block-announces/1, peer=12D3KooWGmJKonCaP9NGW4nq6B2RQyYvoWKUJWQGGzCCPjCxpC7Z	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55677/p2p/12D3KooWNm3F7LeFf8CjpKMJ3CDsUDEDTfeXjyoB7Tc3hB9Z11mt	pkg=network
=== CONT  TestCreateNotificationsMessageHandler_BlockAnnounceHandshake
    testing.go:1152: race detected during execution of test
=== CONT  TestEncodeBlockRequestMessage
--- FAIL: TestCreateNotificationsMessageHandler_BlockAnnounceHandshake (1.72s)
=== CONT  TestMessageCacheError
--- PASS: TestEncodeBlockRequestMessage (0.00s)
=== CONT  TestProtectUnprotectPeer
--- PASS: TestMessageCacheError (0.00s)
=== CONT  TestPersistentPeers
--- PASS: TestProtectUnprotectPeer (0.00s)
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPersistentPeers3295774362/001/TestPersistentPeers/node-a/node.key	pkg=network
2021-12-07T09:49:19-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:19-04:00 DBUG starting DHT with bootnodes [{12D3KooWDnfzYuoGtGTuVFzxZsaAXRNwuAGdbdDmZSSwuyqPeKPZ: [/ip4/127.0.0.1/tcp/55665]}]...	pkg=network
2021-12-07T09:49:19-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:19-04:00 WARN failed to advertise in the DHT: failed to find any peer in table	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:19-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:19-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55678/p2p/12D3KooWLJP9Dx6XxpgSBg6rR5tFn3QqhN6XWJwnQzggwAGEbKuz	pkg=network
=== CONT  TestService_Health
    testing.go:1152: race detected during execution of test
=== CONT  TestBroadcastDuplicateMessage
--- FAIL: TestService_Health (0.86s)
2021-12-07T09:49:19-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBroadcastDuplicateMessage1959176661/001/TestBroadcastDuplicateMessage/nodeA/node.key	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMaxPeers3065712103/003/TestMaxPeers/node2/node.key	pkg=network
2021-12-07T09:49:20-04:00 WARN min peers higher than max peers; setting to default	pkg=network
2021-12-07T09:49:20-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestRemovePeer2086655697/002/TestRemovePeer/nodeB/node.key	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55680/p2p/12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55681/p2p/12D3KooWB8E8pokfGRjM3MqpUJ9HjWvNG6FBh25c2YSf1SPZLWhS	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55682/p2p/12D3KooWPdq14dHBGej2nTRo4VQ1QEhztignfSCL8gTRP3pYVtKT	pkg=network
2021-12-07T09:49:20-04:00 DBUG bootstrapping to peer 12D3KooWEAt3EiWF6vqj4QWLJAs8Yu9QZgqxo7hprVMFsjhAJJ4g	pkg=network
==================
WARNING: DATA RACE
Write at 0x00c0003a27d8 by goroutine 90:
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:87 +0x557
  github.com/ChainSafe/gossamer/dot/network.TestPersistPeerStore()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:319 +0x43e
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous read at 0x00c0003a27d8 by goroutine 872:
  github.com/ChainSafe/gossamer/dot/network.(*Service).startTxnBatchProcessing()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/transaction.go:123 +0x26a
  github.com/ChainSafe/gossamer/dot/network.(*Service).createBatchMessageHandler·dwrap·25()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/transaction.go:150 +0x47

Goroutine 90 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 872 (finished) created at:
  github.com/ChainSafe/gossamer/dot/network.(*Service).createBatchMessageHandler()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/transaction.go:150 +0xd8
  github.com/ChainSafe/gossamer/dot/network.(*Service).Start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:215 +0x7be
  github.com/ChainSafe/gossamer/dot/network.createTestService()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:106 +0x788
  github.com/ChainSafe/gossamer/dot/network.createServiceHelper()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:47 +0x244
  github.com/ChainSafe/gossamer/dot/network.TestPersistPeerStore()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:300 +0x5c
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
2021-12-07T09:49:20-04:00 DBUG connection successful with peer 12D3KooWEAt3EiWF6vqj4QWLJAs8Yu9QZgqxo7hprVMFsjhAJJ4g	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55672/p2p/12D3KooWLtXSCQueZk1zQQZRmyY7VLQJggATzyTBAXTHssoa9opF	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestPersistentPeers3295774362/002/TestPersistentPeers/node-b/node.key	pkg=network
2021-12-07T09:49:20-04:00 WARN Bootstrap is enabled but no bootstrap nodes are defined	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55683/p2p/12D3KooWLXhe1yWKYyk9BqKyXpigK7DfpeKGrJiTW7b22c8Z4MpT	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 DBUG cleaning up outbound handshake data for protocol=/gossamer/test/0/block-announces/1, peer=12D3KooWKRyzVWW6ChFjQjK4miCty85Niy49tpPV95XdKu1BcvMA	pkg=network
2021-12-07T09:49:20-04:00 DBUG failed to send handshake to peer 12D3KooWKRyzVWW6ChFjQjK4miCty85Niy49tpPV95XdKu1BcvMA on protocol /gossamer/test/0/block-announces/1: handshake timeout reached	pkg=network
2021-12-07T09:49:20-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBroadcastDuplicateMessage1959176661/002/TestBroadcastDuplicateMessage/nodeB/node.key	pkg=network
2021-12-07T09:49:20-04:00 DBUG connection successful with peer 12D3KooWLJP9Dx6XxpgSBg6rR5tFn3QqhN6XWJwnQzggwAGEbKuz	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:20-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55684/p2p/12D3KooWEKUkNUxmHJB8vu4FXiH8eYDj68u4qjdtiHhZWVHLVquV	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMaxPeers3065712103/004/TestMaxPeers/node3/node.key	pkg=network
2021-12-07T09:49:20-04:00 WARN min peers higher than max peers; setting to default	pkg=network
=== CONT  TestMaxPeers
    connmgr_test.go:73: 
        	Error Trace:	service_test.go:102
        	            				connmgr_test.go:73
        	Error:      	Received unexpected error:
        	            	failed to listen on any addresses: [listen tcp4 0.0.0.0:55685: socket: too many open files]
        	Test:       	TestMaxPeers
2021-12-07T09:49:20-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:20-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:21-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:21-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestPersistPeerStore
    testing.go:1152: race detected during execution of test
--- FAIL: TestPersistPeerStore (2.51s)
=== CONT  TestBroadcastMessages
=== CONT  TestBeginDiscovery
    testing.go:1152: race detected during execution of test
--- FAIL: TestBeginDiscovery (3.83s)
=== CONT  TestStartService
=== CONT  TestMaxPeers
    testing.go:1152: race detected during execution of test
=== CONT  Test_sizedBufferPool_race
--- FAIL: TestMaxPeers (2.71s)
=== CONT  TestBuildIdentity
--- PASS: Test_sizedBufferPool_race (0.01s)
=== CONT  TestMinPeers
--- PASS: TestBuildIdentity (0.01s)
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBroadcastMessages1014623317/001/TestBroadcastMessages/nodeA/node.key	pkg=network
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestStartService1316991366/001/TestStartService/node/node.key	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMinPeers2134942998/001/TestMinPeers/node0/node.key	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG connection dropped successfully for peer 12D3KooWEAt3EiWF6vqj4QWLJAs8Yu9QZgqxo7hprVMFsjhAJJ4g	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:21-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55687/p2p/12D3KooWP23THBBSA2sybVkn3yTftg5r9ASJem5atYjSSx6nkBxv	pkg=network
==================
WARNING: DATA RACE
Write at 0x00c03f0a1ab8 by goroutine 87:
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastDuplicateMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:248 +0xe8b
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous read at 0x00c03f0a1ab8 by goroutine 454:
  github.com/ChainSafe/gossamer/dot/network.(*Service).sendData()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:285 +0x3b2
  github.com/ChainSafe/gossamer/dot/network.(*Service).broadcastExcluding·dwrap·10()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:419 +0xb4

Goroutine 87 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 454 (finished) created at:
  github.com/ChainSafe/gossamer/dot/network.(*Service).broadcastExcluding()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:419 +0x467
  github.com/ChainSafe/gossamer/dot/network.(*Service).GossipMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:530 +0x3d9
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastDuplicateMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:241 +0xd56
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:21-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55686/p2p/12D3KooWEnuRQdQAYqA1Ltk6N9nQr9QkDd6RTfM1MMxuar9uADLg	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 DBUG gossiping from host 12D3KooWH8sQrU7BnVyQZXDWpzYME2sPhBvm4Givgx8k2J6siEDM message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:21-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:21-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55688/p2p/12D3KooWG3trjP6icopsMp8H4BrBWSmJxyAnK3cS4oJv8KqWSC3a	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c03f01e2a0 by goroutine 87:
  runtime.mapaccess1_faststr()
      /usr/local/go/src/runtime/map_faststr.go:12 +0x0
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastDuplicateMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:255 +0xf78
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c03f01e2a0 by goroutine 416:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x1f5
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 87 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 416 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c0217aa4a8 by goroutine 87:
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastDuplicateMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:255 +0xf85
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c0217aa4a8 by goroutine 416:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x204
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 87 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 416 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
2021-12-07T09:49:21-04:00 DBUG failed to read from stream using protocol /gossamer/test/0/block-announces/1: failed to read length: stream reset	pkg=network
2021-12-07T09:49:21-04:00 DBUG connection dropped successfully for peer 12D3KooWLXhe1yWKYyk9BqKyXpigK7DfpeKGrJiTW7b22c8Z4MpT	pkg=network
2021-12-07T09:49:21-04:00 DBUG connection successful with peer 12D3KooWLXhe1yWKYyk9BqKyXpigK7DfpeKGrJiTW7b22c8Z4MpT	pkg=network
=== CONT  TestRemovePeer
    testing.go:1152: race detected during execution of test
=== CONT  Test_HandshakeTimeout
    testing.go:1152: race detected during execution of test
--- FAIL: TestRemovePeer (2.57s)
=== CONT  TestCreateNotificationsMessageHandler_HandleTransaction
--- FAIL: Test_HandshakeTimeout (13.11s)
=== CONT  TestExternalAddrsPublicIP
==================
WARNING: DATA RACE
Write at 0x00c0a5802370 by goroutine 87:
  runtime.closechan()
      /usr/local/go/src/runtime/chan.go:355 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).Stop()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:144 +0x7e
  github.com/ChainSafe/gossamer/dot/network.(*Service).Stop()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:456 +0x223
  github.com/ChainSafe/gossamer/dot/network.createTestService.func1()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:110 +0x4a
  testing.(*common).Cleanup.func1()
      /usr/local/go/src/testing/testing.go:912 +0x199
  testing.(*common).runCleanup()
      /usr/local/go/src/testing/testing.go:1049 +0x154
  testing.tRunner.func2()
      /usr/local/go/src/testing/testing.go:1253 +0x4f
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1265 +0x268
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous read at 0x00c0a5802370 by goroutine 341:
  runtime.chansend()
      /usr/local/go/src/runtime/chan.go:158 +0x0
  github.com/ChainSafe/gossamer/dot/peerset.(*Handler).ReportPeer()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/peerset/handler.go:77 +0xf0
  github.com/ChainSafe/gossamer/dot/network.(*Service).sendData()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:315 +0x957
  github.com/ChainSafe/gossamer/dot/network.(*Service).broadcastExcluding·dwrap·10()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:419 +0xb4

Goroutine 87 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 341 (finished) created at:
  github.com/ChainSafe/gossamer/dot/network.(*Service).broadcastExcluding()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/notifications.go:419 +0x467
  github.com/ChainSafe/gossamer/dot/network.(*Service).GossipMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service.go:530 +0x3d9
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastDuplicateMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:252 +0xeda
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
=== CONT  TestBroadcastDuplicateMessage
    testing.go:1152: race detected during execution of test
=== CONT  TestBlockAnnounceHandshakeSize
--- FAIL: TestBroadcastDuplicateMessage (1.98s)
=== CONT  Test_PeerSupportsProtocol
--- PASS: TestBlockAnnounceHandshakeSize (0.00s)
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestExternalAddrsPublicIP1277160877/001/TestExternalAddrsPublicIP/node/node.key	pkg=network
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_HandleTransaction1495981099/001/TestCreateNotificationsMessageHandler_HandleTransaction/nodeA/node.key	pkg=network
2021-12-07T09:49:21-04:00 DBUG using config PublicIP: 10.0.5.2	pkg=network
2021-12-07T09:49:21-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_PeerSupportsProtocol2165929546/001/Test_PeerSupportsProtocol/nodeA/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestBroadcastMessages1014623317/002/TestBroadcastMessages/nodeB/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMinPeers2134942998/002/TestMinPeers/node1/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55690/p2p/12D3KooWFELyQ3o3kxzwgfT7DVK57dbEjnyEAgQBGv4YMPWFJ8of	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/10.0.5.2/tcp/55690/p2p/12D3KooWFELyQ3o3kxzwgfT7DVK57dbEjnyEAgQBGv4YMPWFJ8of	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55689/p2p/12D3KooWDBTPy8cHxnW1G2t2yDvnF4suaAKEWrkHyassa577bRa5	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55691/p2p/12D3KooWJrgz5bedFef26GJEG3fyicmPusQHUtTaBa22jPw1XuKT	pkg=network
=== CONT  TestStartService
    testing.go:1152: race detected during execution of test
--- FAIL: TestStartService (1.02s)
=== CONT  TestEncodeBlockAnnounce
=== CONT  TestExternalAddrs
--- PASS: TestEncodeBlockAnnounce (0.00s)
2021-12-07T09:49:22-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestExternalAddrs1362798046/001/TestExternalAddrs/node/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55692/p2p/12D3KooWAtb22j1mLxT7ouqxWjh3mSDELvAkC4NNhSgULYmSH7Yu	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55693/p2p/12D3KooWAiXz4XU6NEfxDTmVTo1pjmHnwMCnfzxHYMEEZQiQCAxj	pkg=network
=== CONT  TestPersistentPeers
    testing.go:1152: race detected during execution of test
--- FAIL: TestPersistentPeers (2.77s)
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55694/p2p/12D3KooWBW7SbgJPUD3tg6TMyjJiDyETtnnVLftXZxngZMkvSUdh	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
=== CONT  TestExternalAddrsPublicIP
    testing.go:1152: race detected during execution of test
--- FAIL: TestExternalAddrsPublicIP (0.86s)
2021-12-07T09:49:22-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestCreateNotificationsMessageHandler_HandleTransaction1495981099/002/TestCreateNotificationsMessageHandler_HandleTransaction/nodeB/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/Test_PeerSupportsProtocol2165929546/002/Test_PeerSupportsProtocol/nodeB/node.key	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55695/p2p/12D3KooWAXBVQW5m7m3rumuxawPS7iuSLBVAZVQfC1naZmezyqVk	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:22-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:22-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55696/p2p/12D3KooWFBAhx16WaH4Qe1b6BFatHzKhFfhkeV9VDD4gtcZkg8wr	pkg=network
2021-12-07T09:49:22-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:23-04:00 DBUG gossiping from host 12D3KooWP23THBBSA2sybVkn3yTftg5r9ASJem5atYjSSx6nkBxv message of type 3: BlockAnnounceMessage ParentHash=0x0000000000000000000000000000000000000000000000000000000000000000 Number=896 StateRoot=0x0000000000000000000000000000000000000000000000000000000000000000 ExtrinsicsRoot=0x0000000000000000000000000000000000000000000000000000000000000000 Digest={{<nil> map[2:{[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]} 4:{[0 0 0 0] []} 5:{[0 0 0 0] []} 6:{[0 0 0 0] []}]} []}	pkg=network
2021-12-07T09:49:23-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:23-04:00 INFO Generating p2p identity with seed 0 and key file /var/folders/vj/qljhg8m12mxfl4bfs4yb_7qh0000gn/T/TestMinPeers2134942998/003/TestMinPeers/nodeB/node.key	pkg=network
2021-12-07T09:49:23-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
--- PASS: TestExternalAddrs (0.86s)
2021-12-07T09:49:23-04:00 INFO registered notifications sub-protocol /gossamer/test/0/block-announces/1	pkg=network
2021-12-07T09:49:23-04:00 INFO registered notifications sub-protocol /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:23-04:00 INFO Started listening on /ip4/127.0.0.1/tcp/55698/p2p/12D3KooWHeTpguzUYAMvmZQ19WubbKdxq96rvYVNUUPYZGLaz8BP	pkg=network
2021-12-07T09:49:23-04:00 DBUG bootstrapping to peer 12D3KooWG3trjP6icopsMp8H4BrBWSmJxyAnK3cS4oJv8KqWSC3a	pkg=network
2021-12-07T09:49:23-04:00 DBUG bootstrapping to peer 12D3KooWAiXz4XU6NEfxDTmVTo1pjmHnwMCnfzxHYMEEZQiQCAxj	pkg=network
2021-12-07T09:49:23-04:00 DBUG connection successful with peer 12D3KooWG3trjP6icopsMp8H4BrBWSmJxyAnK3cS4oJv8KqWSC3a	pkg=network
2021-12-07T09:49:23-04:00 DBUG connection successful with peer 12D3KooWAiXz4XU6NEfxDTmVTo1pjmHnwMCnfzxHYMEEZQiQCAxj	pkg=network
2021-12-07T09:49:23-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:23-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
--- PASS: Test_PeerSupportsProtocol (1.72s)
2021-12-07T09:49:23-04:00 INFO started network service with supported protocols /p2p/id/delta/1.0.0, /ipfs/id/1.0.0, /ipfs/id/push/1.0.0, /ipfs/ping/1.0.0, /gossamer/test/0/sync/2, /gossamer/test/0/light/2, /gossamer/test/0/block-announces/1, /gossamer/test/0/transactions/1	pkg=network
2021-12-07T09:49:23-04:00 DBUG connection dropped successfully for peer 12D3KooWG3trjP6icopsMp8H4BrBWSmJxyAnK3cS4oJv8KqWSC3a	pkg=network
2021-12-07T09:49:23-04:00 DBUG transaction message TransactionMessage extrinsics count=2 for peer 12D3KooWAXBVQW5m7m3rumuxawPS7iuSLBVAZVQfC1naZmezyqVk not included into batch	pkg=network
=== CONT  TestMinPeers
    testing.go:1152: race detected during execution of test
--- FAIL: TestMinPeers (2.59s)
==================
WARNING: DATA RACE
Read at 0x00c09be7aba0 by goroutine 86:
  runtime.mapaccess1_faststr()
      /usr/local/go/src/runtime/map_faststr.go:12 +0x0
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastMessages()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:181 +0x9a4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c09be7aba0 by goroutine 668:
  runtime.mapassign_faststr()
      /usr/local/go/src/runtime/map_faststr.go:202 +0x0
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x1f5
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 86 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 668 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
==================
WARNING: DATA RACE
Read at 0x00c06b6133c8 by goroutine 86:
  github.com/ChainSafe/gossamer/dot/network.TestBroadcastMessages()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:181 +0x9b1
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c06b6133c8 by goroutine 668:
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:137 +0x204
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleMessage-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:135 +0x6d
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).readStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:184 +0x3bc
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:132 +0xab
  github.com/ChainSafe/gossamer/dot/network.(*testStreamHandler).handleStream-fm()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/helpers_test.go:124 +0x4d
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).SetStreamHandler.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:529 +0x86
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler·dwrap·3()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x74

Goroutine 86 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 668 (running) created at:
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:372 +0x7ca
  github.com/libp2p/go-libp2p/p2p/host/basic.(*BasicHost).newStreamHandler-fm()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p@v0.15.1/p2p/host/basic/basic_host.go:329 +0x4d
  github.com/libp2p/go-libp2p-swarm.(*Conn).start.func1.1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-swarm@v0.5.3/swarm_conn.go:125 +0xe4
==================
2021-12-07T09:49:25-04:00 DBUG failed to read from stream using protocol /gossamer/test/0/block-announces/1: failed to read length: stream reset	pkg=network
=== CONT  TestCreateNotificationsMessageHandler_HandleTransaction
    testing.go:1152: race detected during execution of test
--- FAIL: TestCreateNotificationsMessageHandler_HandleTransaction (3.37s)
=== CONT  TestBroadcastMessages
    testing.go:1152: race detected during execution of test
--- FAIL: TestBroadcastMessages (3.99s)
2021-12-07T09:49:27-04:00 DBUG no peers yet, waiting to start DHT...	pkg=network
2021-12-07T09:49:27-04:00 DBUG starting DHT with bootnodes [{12D3KooWA8qur5nqe3oH5NbQQS1xqsMDqgBGPRKHufqhEnnnuMnW: [/ip4/127.0.0.1/tcp/55669]}]...	pkg=network
2021-12-07T09:49:28-04:00 DBUG no peers yet, waiting to start DHT...	pkg=network
2021-12-07T09:49:28-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:28-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:28-04:00 WARN failed to advertise in the DHT: failed to find any peer in table	pkg=network
2021-12-07T09:49:28-04:00 DBUG no peers yet, waiting to start DHT...	pkg=network
2021-12-07T09:49:28-04:00 DBUG starting DHT with bootnodes [{12D3KooWFLXde5C18HZ88BJcWnsXQhKEhd1J9BX5brRfFegoD3tx: [/ip4/127.0.0.1/tcp/55663]}]...	pkg=network
==================
WARNING: DATA RACE
Read at 0x00c040f0ca90 by goroutine 37:
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x264
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Previous write at 0x00c040f0ca90 by goroutine 177:
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:108 +0x6b2
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 37 (running) created at:
  testing.(*T).Run()
      /usr/local/go/src/testing/testing.go:1306 +0x726
  testing.runTests.func1()
      /usr/local/go/src/testing/testing.go:1598 +0x99
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.runTests()
      /usr/local/go/src/testing/testing.go:1596 +0x7ca
  testing.(*M).Run()
      /usr/local/go/src/testing/testing.go:1504 +0x9d1
  github.com/ChainSafe/gossamer/dot/network.TestMain()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/service_test.go:118 +0x33
  main.main()
      _testmain.go:205 +0x264

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c0667a9530 by goroutine 963:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x111

Previous write at 0x00c0667a9530 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:139 +0x93d
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b428a80 by goroutine 963:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindLocal()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:714 +0x5d
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:625 +0x1b1
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c06b428a80 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c0667a9538 by goroutine 852:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func2()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:245 +0x115

Previous write at 0x00c0667a9538 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:139 +0x93d
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 852 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:243 +0x617
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b428ad8 by goroutine 963:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x126
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c06b428ad8 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b4293b0 by goroutine 963:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x146
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c06b4293b0 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c024127d58 by goroutine 963:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:388 +0x70
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c024127d58 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:65 +0x176
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c024127da0 by goroutine 963:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:394 +0xde
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c024127da0 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:65 +0x176
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c024127db8 by goroutine 963:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:399 +0x148
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c024127db8 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:65 +0x176
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c0009c3ab0 by goroutine 963:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:404 +0x2ab
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c0009c3ab0 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:66 +0x1c4
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c0009c3aa8 by goroutine 963:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:404 +0x2cb
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c0009c3aa8 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.newBucket()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/bucket.go:45 +0x12a
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:66 +0x1ad
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b42bb88 by goroutine 963:
  container/list.(*List).Front()
      /usr/local/go/src/container/list/list.go:70 +0x57
  github.com/libp2p/go-libp2p-kbucket.(*peerDistanceSorter).appendPeersFromList()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/sorting.go:40 +0x69
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:404 +0x2e4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func1()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:241 +0x13b

Previous write at 0x00c06b42bb88 by goroutine 177:
  container/list.(*List).Init()
      /usr/local/go/src/container/list/list.go:57 +0x113
  container/list.New()
      /usr/local/go/src/container/list/list.go:62 +0x96
  github.com/libp2p/go-libp2p-kbucket.newBucket()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/bucket.go:45 +0x121
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:66 +0x1ad
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:124 +0x73c
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 963 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:239 +0x417
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b429500 by goroutine 852:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindLocal()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:714 +0x5d
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:625 +0x1b1
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func2()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:245 +0x144

Previous write at 0x00c06b429500 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:134 +0x911
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 852 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:243 +0x617
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b429558 by goroutine 852:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x126
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func2()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:245 +0x144

Previous write at 0x00c06b429558 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:134 +0x911
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 852 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:243 +0x617
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c06b429e30 by goroutine 852:
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x146
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func2()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:245 +0x144

Previous write at 0x00c06b429e30 by goroutine 177:
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:273 +0x339
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:134 +0x911
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 852 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:243 +0x617
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
==================
WARNING: DATA RACE
Read at 0x00c024127ed8 by goroutine 852:
  github.com/libp2p/go-libp2p-kbucket.(*RoutingTable).NearestPeers()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:388 +0x70
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runQuery()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:151 +0x172
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).runLookupWithFollowup()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/query.go:81 +0xc4
  github.com/libp2p/go-libp2p-kad-dht.(*IpfsDHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/routing.go:629 +0x3d9
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer.func2()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:245 +0x144

Previous write at 0x00c024127ed8 by goroutine 177:
  github.com/libp2p/go-libp2p-kbucket.NewRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kbucket@v0.4.7/table.go:65 +0x176
  github.com/libp2p/go-libp2p-kad-dht.makeRoutingTable()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:386 +0x2c5
  github.com/libp2p/go-libp2p-kad-dht.makeDHT()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:313 +0xadd
  github.com/libp2p/go-libp2p-kad-dht.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dht.go:180 +0x2b7
  github.com/libp2p/go-libp2p-kad-dht/dual.New()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:134 +0x911
  github.com/ChainSafe/gossamer/dot/network.(*discovery).start()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery.go:103 +0x688
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery·dwrap·26()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x39

Goroutine 852 (running) created at:
  github.com/libp2p/go-libp2p-kad-dht/dual.(*DHT).FindPeer()
      /Users/eclesiojunior/go/pkg/mod/github.com/libp2p/go-libp2p-kad-dht@v0.11.1/dual/dual.go:243 +0x617
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:91 +0x292
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47

Goroutine 177 (running) created at:
  github.com/ChainSafe/gossamer/dot/network.newTestDiscovery()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:45 +0x4d7
  github.com/ChainSafe/gossamer/dot/network.TestKadDHT()
      /Users/eclesiojunior/go/src/github.com/ChainSafe/gossamer/dot/network/discovery_test.go:80 +0xe4
  testing.tRunner()
      /usr/local/go/src/testing/testing.go:1259 +0x22f
  testing.(*T).Run·dwrap·21()
      /usr/local/go/src/testing/testing.go:1306 +0x47
==================
2021-12-07T09:49:29-04:00 DBUG DHT discovery started!	pkg=network
2021-12-07T09:49:29-04:00 DBUG advertising ourselves in the DHT...	pkg=network
2021-12-07T09:49:38-04:00 DBUG no peers yet, waiting to start DHT...	pkg=network
2021-12-07T09:49:38-04:00 DBUG starting DHT with bootnodes [{12D3KooWFLXde5C18HZ88BJcWnsXQhKEhd1J9BX5brRfFegoD3tx: [/ip4/127.0.0.1/tcp/55663]}]...	pkg=network
2021-12-07T09:49:39-04:00 DBUG DHT discovery started!	pkg=network
=== CONT  TestKadDHT
    testing.go:1152: race detected during execution of test
--- FAIL: TestKadDHT (22.31s)
FAIL
FAIL	github.com/ChainSafe/gossamer/dot/network	32.338s
FAIL
